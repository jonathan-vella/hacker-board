<!-- Generated by 08-Deploy agent | 2026-02-20 · Updated for Phase 18 -->

# HackerBoard — Deployment Summary

![Step](https://img.shields.io/badge/Step-06-blue)
![Type](https://img.shields.io/badge/Type-Deployment%20Summary-purple)
![Status](https://img.shields.io/badge/Status-Pending%20Redeployment-yellow)
![Agent](https://img.shields.io/badge/Agent-Deploy-orange)
![Region](https://img.shields.io/badge/Region-centralus-blue)

> **Phase 18 Migration**: Code-complete, pending redeployment
> **Subscription**: noalz (`00858ffc-dded-4f0f-8bbf-e17fff0d47d9`) | **Tenant**: Lord of the Cloud

---

## Table of Contents

- [Migration Status](#migration-status)
- [Existing Resources](#existing-resources)
- [New Resources (App Service + ACR)](#new-resources-app-service--acr)
- [Expected Key Outputs](#expected-key-outputs)
- [Pre-Deployment Checklist](#pre-deployment-checklist)
- [Post-Deploy Verification Plan](#post-deploy-verification-plan)
- [Next Steps](#next-steps)

---

## Migration Status

> [!IMPORTANT]
> **Phase 18 (App Service + ACR Migration) is code-complete.** All Bicep templates, application code, CI/CD pipelines, security hardening, and tests are ready. Redeployment via `deploy.ps1` will provision the new resources (ACR + App Service) alongside existing resources (Cosmos DB, Log Analytics, App Insights).

| Phase            | Description                                         | Status      |
| ---------------- | --------------------------------------------------- | ----------- |
| 18.1             | Express Server + Adapter Layer                      | ✅ Complete |
| 18.2             | Function File Refactoring (10 files)                | ✅ Complete |
| 18.3             | Container Setup (Dockerfile, .dockerignore)         | ✅ Complete |
| 18.4             | Bicep Infrastructure (ACR, App Service, main.bicep) | ✅ Complete |
| 18.5             | CI/CD Pipeline (deploy-app.yml + Trivy)             | ✅ Complete |
| 18.6             | Scripts (deploy.ps1 updated)                        | ✅ Complete |
| 18.7             | Tests (137 pass — 76 API + 61 UI)                   | ✅ Complete |
| 18.8             | Documentation updates                               | ✅ Complete |
| 18.9             | Cleanup (SWA artifacts removed)                     | ✅ Complete |
| Security Review  | 0 critical, 2 high fixed, 2 medium deferred         | ✅ Complete |
| **Redeployment** | **Run `deploy.ps1` with new params**                | ⬜ Pending  |

---

## Existing Resources

These resources are already provisioned in `rg-hacker-board-prod` and will be retained:

| Resource                          | Name                       | Location  | State     |
| --------------------------------- | -------------------------- | --------- | --------- |
| Resource Group                    | `rg-hacker-board-prod`     | centralus | Succeeded |
| Log Analytics Workspace           | `law-hacker-board-prod`    | centralus | Succeeded |
| Application Insights              | `appi-hacker-board-prod`   | centralus | Succeeded |
| Cosmos DB Account (Serverless)    | `cosmos-hacker-board-prod` | centralus | Succeeded |
| Cosmos DB Database + 6 Containers | `hackerboard`              | —         | Succeeded |

> **Note**: If a legacy Static Web App (`swa-hacker-board-prod`) still exists in the resource group, delete it after the App Service deployment is verified: `az staticwebapp delete -n swa-hacker-board-prod -g rg-hacker-board-prod`

---

## New Resources (App Service + ACR)

Resources to be created by `deploy.ps1`:

| Resource                       | Name                              | SKU / Tier | AVM Module                           |
| ------------------------------ | --------------------------------- | ---------- | ------------------------------------ |
| Container Registry             | `crhackerboardprod`               | Basic      | `container-registry/registry:0.10.0` |
| App Service Plan               | `asp-hacker-board-prod`           | B1 Linux   | `web/serverfarm:0.7.0`               |
| Web App for Containers         | `app-hacker-board-prod`           | Linux      | `web/site:0.21.0`                    |
| Easy Auth (authsettingsV2)     | (config on Web App)               | —          | `configs` array                      |
| ACR Pull Role Assignment       | App Service MI → ACR              | —          | Native Bicep                         |
| Cosmos DB RBAC Role Assignment | App Service MI → Data Contributor | —          | Native Bicep                         |

**Expected total**: 15+ resources (6 existing + 6 new + role assignments)

---

## Expected Key Outputs

| Output               | Expected Value                                              |
| -------------------- | ----------------------------------------------------------- |
| App Service Hostname | `https://app-hacker-board-prod.azurewebsites.net`           |
| App Service Name     | `app-hacker-board-prod`                                     |
| ACR Login Server     | `crhackerboardprod.azurecr.io`                              |
| ACR Name             | `crhackerboardprod`                                         |
| Cosmos DB Endpoint   | `https://cosmos-hacker-board-prod.documents.azure.com:443/` |
| Cosmos DB Account    | `cosmos-hacker-board-prod`                                  |
| Resource Group       | `rg-hacker-board-prod`                                      |

---

## Pre-Deployment Checklist

| #   | Task                                                                                                              | Status |
| --- | ----------------------------------------------------------------------------------------------------------------- | ------ |
| 1   | Create GitHub OAuth App (callback: `https://app-hacker-board-prod.azurewebsites.net/.auth/login/github/callback`) | ⬜     |
| 2   | Have GitHub OAuth Client ID ready                                                                                 | ⬜     |
| 3   | Have GitHub OAuth Client Secret ready                                                                             | ⬜     |
| 4   | Verify Azure CLI login: `az account show`                                                                         | ⬜     |
| 5   | Verify MFA token is fresh: `az account get-access-token`                                                          | ⬜     |
| 6   | Verify Bicep builds clean: `az bicep build --file infra/main.bicep`                                               | ✅     |
| 7   | All 137 tests pass: `npm run test:all`                                                                            | ✅     |

---

## Post-Deploy Verification Plan

| Check                              | Command / Method                                                                                                              |
| ---------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- |
| App Service state = Running        | `az webapp show --name app-hacker-board-prod -g rg-hacker-board-prod --query state`                                           |
| ACR provisioning = Succeeded       | `az acr show --name crhackerboardprod -g rg-hacker-board-prod --query provisioningState`                                      |
| Cosmos DB `disableLocalAuth: true` | `az cosmosdb show --name cosmos-hacker-board-prod -g rg-hacker-board-prod --query disableLocalAuth`                           |
| Cosmos DB RBAC assignments ≥ 1     | `az cosmosdb sql role assignment list --account-name cosmos-hacker-board-prod -g rg-hacker-board-prod --query "length(@)"`    |
| App Service `COSMOS_ENDPOINT` set  | `az webapp config appsettings list --name app-hacker-board-prod -g rg-hacker-board-prod --query "[?name=='COSMOS_ENDPOINT']"` |
| Health check                       | `curl https://app-hacker-board-prod.azurewebsites.net/api/health`                                                             |

---

## Next Steps

1. **Create GitHub OAuth App** with callback URL: `https://app-hacker-board-prod.azurewebsites.net/.auth/login/github/callback`
2. **Run deployment**: `./deploy.ps1 -CostCenter "microhack" -TechnicalContact "jonathan@lordofthecloud.eu" -GitHubOAuthClientId "<id>" -GitHubOAuthClientSecret "<secret>"`
3. **Build and push container image**: `docker build -t crhackerboardprod.azurecr.io/hacker-board:latest . && az acr login --name crhackerboardprod && docker push crhackerboardprod.azurecr.io/hacker-board:latest`
4. **Set `AZURE_CREDENTIALS`** in GitHub repo secrets for CI/CD pipeline
5. **Verify health**: `curl https://app-hacker-board-prod.azurewebsites.net/api/health`
6. **Seed demo data** (optional): `node scripts/seed-demo-data.js`

---

## Entra ID Phase (From Original Deployment)

| Step                                                           | Result                                            |
| -------------------------------------------------------------- | ------------------------------------------------- |
| Entra app registration `hacker-board` created                  | ✅ App ID: `4e147902-3a63-46ae-9ffe-2528236cc0b7` |
| Service principal created                                      | ✅ OID: `068fd80e-4c3b-4cf4-a98c-152c19e0850d`    |
| Admin role assigned to deployer (`jonathan@lordofthecloud.eu`) | ✅ Confirmed                                      |

> Entra ID app registration will be reused by the App Service deployment. No changes needed.

---

← Back to [agent-output/hacker-board](README.md)
